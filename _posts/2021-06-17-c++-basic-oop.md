---
layout: post
title:  "[C++] OOP"
summary: "object oriented programming"
author: moon
date: '2021-06-17 12:35:23 +0900'
category: cpp
thumbnail: /assets/img/posts/bitoper.PNG
keywords: cpp, oop,abstract, inherit, capsulize
permalink: /blog/data-structure/graph
usemathjax: true
---
## Object-Oriented-Programming

---

## 캡슐화

---

- 정의
    - 캡슐화는 객체의 속성과 기능을 하나로 묶고 세부 구현 내용은 클래스 안으로 숨기는 것
- 접근제어자를 통해 구현된다.실생활에 대한 공통적인 특징을 속성과 기능으로 구분하고 각각 멤버 변수와 멤버 함수로 만들어서 클래스로 표현

## 상속

---

- 정의
    - 다른 클래스를 이어받아 기능이나 변수들을 사용할 수 있게 되는것

    ```cpp
    class CParent
    {
    	private:
    		int m_i;

    	public:
    		CParent():m_i(0){};
    		CParent():{};
    }
    //상속
    class CChild : public CParent
    {
    	private:
    		float m_f:
    	public:
    		CChild():m_f(0.f){}
    }
    ```

- 참조와의 차이

- 오버라이딩
    - 부모가 가지고 있는 기능을 자식클래스에서 재정의 하는것
    - 접근지정자, 파라미터, 함수이름, 리턴타입이 모두 같아야만 가능
    - 이 오버라이딩 기능은 다형성과 함께 상속을 객체지향의 꽃으로 만들어주었다.
- 소멸자의 호출
    - 생성자와 달리 실행, 호출 순서 모두 같다 (자식 → 부모)

## 다형성

---

- 상속관계일때 부모의 타입으로 모든 자식이 될 수 있는걸 말한다.

    ```cpp
    CParent* pParent = &parent;
    pParent->show();
    //다형성
    pParent = &child;
    pParent->show();
    ```

- 위 코드는 의도한 바는 다형성을 통해 자식의 함수를 호출하는것이나, 포인터로 부모의 포인터만 받고 있기 때문에 부모의 함수가 호출된다.
- 이러한 문제를 해결하기 위해서는 virtual 키워드가 필수다

    ```cpp
    //부모클래스에 선언
    virtual show(){}
    ```

- 이렇게 선언된 함수를 가상함수라고 한다.
- 가상함수가 선언된 클래스는 virtual table pointer를 가지게 된다.
- 클래스 메모리 확장규칙(제일 큰 메모리를 기준으로 확장)에따라 메모리가 확장된다. 즉 virtual table pointer(8바이트)가 가장크다면 8바이트씩 확장된다.
- virtual table pointer는 최상위 부모클래스에 생성이 되게 되는데, 가상함수가 호출될떄 해당 주소에 저장된 테이블을 호출하게된다.
- 이 테이블은 객체가 생성될때, 해당 클래스의 테이블로 생성이된다.(부모클래스라면 부모가상함수 테이블, 자식이라면 자식가상함수 테이블)
- 그렇기 때문에 가상함수를 선언하면 완벽하게 다형성을 실행할 수 있다.
- 이 가상함수는 부모에서 구현되어 상속된 함수들만 호출할 수 있다. 자식에서 새로 구현된 함수는 호출 할 수 없다.

## Down Casting(C++에선 dynamic cast를이용)

---

- 상속관계에서 부모가 자식의 객체를 가지고 있을때 부모의 변수를 자식으로 캐스팅하는걸 말한다.
- 포인터를 캐스팅하는것이기 때문에 매우 위험하다, 그렇기 때문에 꼭 검증을 하고 사용해주는게 좋다.
- 상속시 가상함수가 없으면 자식클래스의 소멸자를 가상함수로 만들어버린다.
    - 소멸자는 실행순서와 호출순서가 같기 때문에 실행이 보장된다.
- 다운캐스팅은 다형성 사용중 자식의 포인터를 받은 부모의 변수로 자식의 함수를 이용하고 싶을때 사용
- 이때 dynamic cast로 캐스팅하게 되면 안전한 캐스트인지 검사를 해주기 때문에 안전하게 사용할 수 있다.
- dynamic cast가 허용되면 template에 삽입된 클래스를 아니면 null클래스를 반환한다.(RTTI)

## 추상화(Abstract)

---

- 정의
    - 실생활에 대한 공통적인 특징을 속성과 기능으로 구분하고 각각 멤버 변수와 멤버 함수로 만들어서 클래스로 표현하는 과정을 추상화
- 선언

    ```cpp
    class Test{
    	virtual functionNew();
    }

    ```

- 위의 코드선언이 추상화 클래스를 선언한것이다. 추상화클래스는 순수가상함수를 하나라도 포함된 클래스를 의미하는데 이 클래스를 상속받으면 가상함수를 구현해야 추상클래스에서 벗어날 수 있다.